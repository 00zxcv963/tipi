<!DOCTYPE html>
<html>
<head>
	<title>TIPI: 深入理解PHP内核</title>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
	<link href="chm.css" media="screen" rel="stylesheet" type="text/css" />
<link href="highlight.css" media="screen" rel="stylesheet" type="text/css" />
</head>
<body id="portable" class="pdf">
			<div class='page page-break'>
			<h1>第四章 函数的实现<a name='第四章 函数的实现'></a></h1>

<p>函数是一种可以在任何被需要的时候执行的代码块。它不仅仅包括用户自定义的函数，还包括程序语言实现的库函数。</p>

<h2>用户定义的函数<a name='用户定义的函数'></a></h2>

<p>如下所示手册中的展示函数用途的伪代码</p>

<pre class="php"><span class="kw2">function</span> foo<span class="br0">&#40;</span><span class="re0">$arg_1</span><span class="sy0">,</span> <span class="re0">$arg_2</span><span class="sy0">,</span> <span class="sy0">...,</span> <span class="re0">$arg_n</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <a href="http://www.php.net/echo"><span class="kw3">echo</span></a> <span class="st0">&quot;Example function.<span class="es1">\n</span>&quot;</span><span class="sy0">;</span>
    <span class="kw1">return</span> <span class="re0">$retval</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>

<p>任何有效的 PHP 代码都可以编写在函数内部，甚至包括其它函数和类定义。</p>

<blockquote class='note'>
<p>在 PHP 3 中，函数必须在被调用之前定义。而 PHP 4 则不再有这样的条件。除非函数如以下两个范例中有条件的定义。</p>
</blockquote>

<h2>内部函数<a name='内部函数'></a></h2>

<p>PHP 有很多标准的函数和结构。如我们常见的count、strpos、implode等函数，这些都是标准函数，它们都是由标准扩展提供的；
如我们经常用到的isset、empty、eval等函数，这些结构被称之为语言结构。
还有一些函数需要和特定的PHP扩展模块一起编译并开启，否则无法使用。也就是有些扩展是可选的。</p>

<blockquote class='note'>
<p>标准函数的实现存放在ext/standard扩展目录中。</p>
</blockquote>

<h2>匿名函数<a name='匿名函数'></a></h2>

<p>有时我们的一代代码并不需要为它指定一个名称，而只需要它完成特定的工作，
匿名函数的作用是为了扩大函数的使用功能，在PHP 5.3以前，传递函数回调的方式，我们只有两种选择：</p>

<ul>
<li>字符串的函数名</li>
<li>使用create_function创建的返回</li>
</ul>

<p>在PHP5.3以后，我们多了一个选择--Closure。在实现上PHP 5.3中对匿名函数的支持，采用的是把要保持的外部变量，
做为Closure对象的”Static属性”来实现的，关于如何实现我们将在后面的章节介绍。</p>

<h2>变量函数<a name='变量函数'></a></h2>

<p>PHP 支持变量函数的概念。这意味着如果一个变量名后有圆括号，PHP 将寻找与变量的值同名的函数，
并且将尝试执行它。除此之外，这个可以被用于实现回调函数，函数表等。
一个变量函数的简单例子：</p>

<pre class="php"><span class="re0">$func</span> <span class="sy0">=</span> <span class="st_h">'print_r'</span><span class="sy0">;</span>
<span class="re0">$func</span><span class="br0">&#40;</span><span class="st_h">'i am print_r function.'</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>

<blockquote class='note'>
<p>变量函数不能用于语言结构（echo等）</p>
</blockquote>

<p>下面我们将开始关注函数在PHP中具体实现，函数的内部结构，函数的调用，参数传递以及函数返回值等。</p>
		</div>
	</body>
</html>
